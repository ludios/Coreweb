<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=8" />
<title>@tests</title>
</head>
<body>

<style>
div, p, body { font-size: 13px; font-family: Tahoma }
</style>

<div id="CW-debug-log" style="background-color:#ddd"></div>
<div id="CW-print-log" style="background-color:#eee"></div>

<script>
/*
	function to count number of window properties,
	to help make sure nothing (besides __CW_x and CW) are added
*/
__CW_x = {
	enumerate: function(){
		var c = {}, k;
		for(k in window) {
			c[k] = true;
		};
		return c;
	},
	check: function(old){
		var k;
		var newProps = [];
		for(k in window) {
			if(!old[k]) {
				newProps.push(k);
			}
		}
		return newProps;
	}
};
__CW_x.sb = +new Date; /* scripts begin */
__CW_x.propsBefore = __CW_x.enumerate();
</script>
<script>
/**/scriptContent//
</script>

<script>
__CW_x.se = +new Date; /* scripts end */



// TODO: use CW log observer code

// doesn't work well because UnitTest.js is print()ing HTML right now :(

// CW.ISODate.localTime()

// TODO: Don't use the name print; conflicts with window.print
function __CW_print(msg) {
	var textnode = document.createTextNode('[' + CW.localTime() + '] ' + msg);
	var br = document.createElement("br");
	var logd = document.getElementById('CW-print-log');
	logd.appendChild(textnode);
	logd.appendChild(br);
}

//function __CW_print(msg) {
//	var logd = document.getElementById('CW-debug-log');
//	logd.innerHTML += msg + '<br>'
//}


(function(){

__CW_print("Took " + (__CW_x.se-__CW_x.sb) + "ms to load scripts.");

function _startTests() {
	__CW_print('Running tests.<br>');

	var modules = /**/modules//
	var suite = CW.UnitTest.loadFromModules(modules);

	var d = CW.UnitTest.run(suite);
	//d.addCallback(function(){document.body.style.backgroundColor = 'green';});

	function _checkProps() {
		var newProps = __CW_x.check(__CW_x.propsBefore);
		__CW_print('New window properties: ' + newProps.join(','));
	}

	d.addCallback(_checkProps);
}

// TODO: use event listeners?
window.onload = _startTests;

})();

</script>

<!-- TODO: factor out the /@static/ -->


<br>

