<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- IE=8 prevents the user from turning on IE7 compatibility mode -->
<meta http-equiv="X-UA-Compatible" content="IE=8" />
<title>/**/pageTitle//</title>
</head>
<body>

<style>
div, p, body {
	font-size: 13px;
	font-family: Tahoma, sans-serif;
}
</style>

<a href="#" onclick="TestRunnerPage.toggleVisibility('CW-debug-log');return false">Show/hide debug log</a><br>

<div id="CW-debug-log" style="background-color:#ddd;display:none"></div>
<div id="CW-test-log" style="background-color:#ccc"></div>


<script>
/**
 * A function to enumerate and check for new properties,
 * to make sure there's little window pollution besides
 * `TestRunnerPage` and `CW`.
 */
TestRunnerPage = {};
TestRunnerPage.timers = {};

TestRunnerPage.enumerateProperties = function(object) {
	var c = {}, k;
	for(k in object) {
		c[k] = true;
	};
	return c;
}


TestRunnerPage.findNew = function(oldSet, object) {
	var k;
	var newProps = [];
	for(k in object) {
		if(!oldSet[k]) {
			newProps.push(k);
		}
	}
	return newProps;
}


TestRunnerPage.toggleVisibility = function(id) {
	var e = document.getElementById(id);
	if(e.style.display == 'block' || !e.style.display) {
		e.style.display = 'none';
	} else {
		e.style.display = 'block';
	}
}


TestRunnerPage.logNewProps = function() {
	var newProps = TestRunnerPage.findNew(TestRunnerPage.propsBefore, window);
	CW.msg('New window properties: ' + newProps.join(','));
}


TestRunnerPage.startTests = function() {
	CW.msg('Running tests.');

	var modules = /**/moduleString//
	var suite = CW.UnitTest.loadFromModules(modules);

	var d = CW.UnitTest.run(suite);
	d.addCallback(TestRunnerPage.logNewProps);
}


// We look at the properties before we even load the <script>,
// in case there's a bug that leaks a variable at the top-level scope of the script.
TestRunnerPage.propsBefore = TestRunnerPage.enumerateProperties(window);

TestRunnerPage.timers.scriptLoadStart = +new Date; /* scripts begin */
</script>
<script>
/**/scriptContent//
</script>

<script>
TestRunnerPage.timers.scriptLoadEnd = +new Date; /* scripts end */

CW.msg(
	"Took " + (TestRunnerPage.timers.scriptLoadEnd - TestRunnerPage.timers.scriptLoadStart) +
	" ms to load scripts.");

window.onload = TestRunnerPage.startTests;

</script>

<br>

<!-- no need to close -->
