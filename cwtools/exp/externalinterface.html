<!doctype html>
<html>
<head>
	<meta http-equiv="charset" content="text/html; charset=utf-8">
	<title>externalinterface</title>
	<style>
	* {
		font-family: Verdana, sans-serif;
		font-size: 13px;
	}
	body, html {
		background-color: #eee;
	}
	</style>
</head>
<body>

<script>
{{ expandScript("""
goog.require('swfobject');
goog.require('cw.externalinterface');
""") }}
</script>

<div style="white-space: pre-wrap">
Flash ExternalInterface tests, both JS->Flash and Flash->JS

</div>

<div id="Experiments">
</div>

<div id="log">
</div>
<script>
function append(msg) {
	var textnode = document.createTextNode('[' + new Date + '] ' + msg);
	var br = document.createElement("br");
	var logd = document.getElementById('log');
	logd.appendChild(textnode);
	logd.appendChild(br);
}

var ob = null;


function start() {
	append(cw.externalinterface.request("echo_raw", "Hello"));
	append(ob.CallFunction(cw.externalinterface.request("echo_raw", "Hello")));
}


function ready(arg) {
	ob = document.getElementById('Experiments');
	append("ready, arg: " + arg + ", this == window: " + (this === window));
	start();
}


function overflow(arg) {
	if(!ob) {
		ob = document.getElementById('Experiments');
		//overflow(); // on purpose, to add 1 extra stack on JS side
	} //else {
		ob.overflow();
	//}
}


var flashvars = {'onloadcallback': 'ready'};
//var flashvars = {'onloadcallback': 'overflow'};
var params = {};
swfobject.embedSWF("Experiments.swf", "Experiments", "30", "30", "9.0.0", "expressInstall.swf", /*flashvars=*/flashvars, params); // no attributes

</script>

</body>
</html>
